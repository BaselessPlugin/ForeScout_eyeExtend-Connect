{
  "name": "Nile",
  "groups": [
    {
      "name": "connect_nile_nile",
      "label": "Nile Service Device Properties"
    }
  ],
  "action_groups": [
    {
      "name":"connect_nile_nile_action",
      "label":"Nile"
    }
  ],
  "properties": [
    {
      "tag": "connect_nile_mac",
      "label": "User Mac Address",
      "description": "User Mac Address",
      "type": "string",
      "group": "connect_nile_nile",
      "resolvable": false
    },
    {
      "tag": "connect_nile_ip",
      "label": "User IP Address",
      "description": "User IP Address",
      "type": "string",
      "group": "connect_nile_nile",
      "resolvable": false
    },
    {
      "tag": "connect_nile_serialName",
      "label": "Nile Service Device Serial",
      "description": "Nile Service Device Serial",
      "type": "string",
      "group": "connect_nile_nile",
      "resolvable": false,
      "inventory": {
        "enable": true,
        "description": "Nile Service Device Serial"
      }
    },
    {
      "tag": "connect_nile_siteName",
      "label": "Site",
      "description": "Site",
      "type": "string",
      "group": "connect_nile_nile",
      "resolvable": false,
      "inventory": {
        "enable": true,
        "description": "Site Name that User is connected to"
      }
    },
    {
      "tag": "connect_nile_buildingName",
      "label": "Building",
      "description": "Building",
      "type": "string",
      "group": "connect_nile_nile",
      "resolvable": false,
      "inventory": {
        "enable": true,
        "description": "Building Name that User is connected to"
      }
    },
    {
      "tag": "connect_nile_floorName",
      "label": "Floor",
      "description": "User Floor Name",
      "type": "string",
      "group": "connect_nile_nile",
      "resolvable": false,
      "inventory": {
        "enable": true,
        "description": "Floor Name that User is connected to"
      }
    },
    {
      "tag": "connect_nile_segment",
      "label": "Nile Segment",
      "description": "Nile Segment",
      "type": "string",
      "group": "connect_nile_nile",
      "resolvable": false,
      "inventory": {
        "enable": true,
        "description": "Nile Segment associated with the User"
      }
    },
    {
      "tag": "connect_nile_clientStatus",
      "label": "Status",
      "description": "Status of the Client on Nile Service",
      "type": "string",
      "group": "connect_nile_nile",
      "resolvable": false,
      "inventory": {
        "enable": true,
        "description": "Status of the Client on Nile Service"
      }
    },
    {
      "tag": "connect_nile_connectedSince",
      "label": "Connected Since",
      "description": "Last time the Client Authorized on Nile Service",
      "type": "string",
      "group": "connect_nile_nile",
      "resolvable": false
    },
    {
      "tag": "connect_nile_port",
      "label": "Port Number",
      "description": "Port Number of Nile Service",
      "type": "string",
      "group": "connect_nile_nile",
      "resolvable": false,
      "inventory": {
        "enable": true,
        "description": "Port Number of Nile Service"
      }
    },
    {
      "tag": "connect_nile_connectionType",
      "label": "Connection Type",
      "description": "Connection Type of the Client on Nile Service",
      "type": "string",
      "group": "connect_nile_nile",
      "resolvable": false,
      "inventory": {
        "enable": true,
        "description": "Connection Type of the Client on Nile Service"
      }
    },
    {
      "tag": "connect_nile_ssid",
      "label": "SSID",
      "description": "SSID of the Client on Nile Service",
      "type": "string",
      "group": "connect_nile_nile",
      "resolvable": false,
      "inventory": {
        "enable": true,
        "description": "SSID of the Client on Nile Service"
      }
    },
    {
      "tag": "connect_nile_deviceType",
      "label": "Device Type",
      "description": "Device Type of Client on Nile Service",
      "type": "string",
      "group": "connect_nile_nile",
      "resolvable": false,
      "inventory": {
        "enable": true,
        "description": "Device Type of Client on Nile Service"
      }
    },
    {
      "tag": "connect_nile_deviceManufacturer",
      "label": "Device Manufacturer",
      "description": "Device Manufacturer of Client on Nile Service",
      "type": "string",
      "group": "connect_nile_nile",
      "resolvable": false,
      "inventory": {
        "enable": true,
        "description": "Device Manufacturer of Client on Nile Service"
      }
    },
    {
      "tag": "connect_nile_deviceOs",
      "label": "Device OS",
      "description": "Device OS of Client on Nile Service",
      "type": "string",
      "group": "connect_nile_nile",
      "resolvable": false,
      "inventory": {
        "enable": true,
        "description": "Device OS of Client on Nile Service"
      }
    }
  ],
  "actions": [
	  {
      "name": "connect_nile_quarantine",
      "label": "Quarantine Endpoint",
      "group": "connect_nile_nile_action",
      "description": "Quarantine an endpoint",
      "ip_required": false,
      "threshold_percentage": 1,
      "params": [
        {
          "name": "netseg_name",
          "type": "string",
          "default": "<default>",
          "label": "Netsegment Name from Nile Portal to be used as Quarantine Segment",
          "description": "Netsegment Name from Nile Portal to be used as Quarantine Segment"
        }
      ],
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "name": "connect_nile_authorize",
      "label": "Authorize Endpoint",
      "group": "connect_nile_nile_action",
      "description": "Authorize an endpoint",
      "ip_required": false,
      "threshold_percentage": 1,
      "params": [
        {
          "name": "netseg_name",
          "type": "string",
          "default": "<default>",
          "label": "Netsegment Name from Nile Portal to be used as Authorized Segment",
          "description": "Netsegment Name from Nile Portal to be used as Authorized Segment"
        }
      ],
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    }
  ],
  "scripts": [
    {
        "name": "nile_resolve.py",
        "properties": [
            "connect_nile_mac",
            "connect_nile_ip",
            "connect_nile_serialName",
            "connect_nile_siteName",
            "connect_nile_buildingName",
            "connect_nile_floorName",
            "connect_nile_segment",
            "connect_nile_clientStatus",
            "connect_nile_connectedSince",
            "connect_nile_port",
            "connect_nile_connectionType",
            "connect_nile_ssid",
            "connect_nile_deviceType",
            "connect_nile_deviceManufacturer",
            "connect_nile_deviceOs"
        ]
    },
    {
      "name": "nile_poll.py",
      "discovery": true
    },
	  {
      "name": "nile_quarantine.py",
      "actions": [
        "connect_nile_quarantine"
      ]
    },
    {
      "name": "nile_test.py",
      "test": true
    },
    {
      "name":"nile_authorization.py",
      "actions": [
        "connect_nile_authorize"
      ]
    },
    {
      "name": "nile_functions.py",
      "library_file": true
    }
  ],
  "policy_template": {
    "policy_template_group": {
       "name": "connect_nile",
       "label": "Nile",
       "display": "Nile",
       "description": "Nile templates",
       "full_description": "<html>Use Nile policy templates to manage devices in a Nile environment</html>",
       "title_image": "connect_nile.png"
    },
    "policies": [
	    {
        "name": "connect_nile_agent_authorize",
        "label": "Nile Agent Authorize",
        "display": "Nile Agent Authorize",
        "help": "Nile Agent Authorize Policy",
        "description": "Authorizes a device on Nile Network by moving to Authorized Segment",
        "file_name": "NileAuthorize.xml",
        "full_description": "<html>Use this policy template to authorize a device that is compliant on Nile Network.</html>",
        "title_image": "connect_nile_authorize.png"
      },
	    {
        "name": "connect_nile_agent_quarantine",
        "label": "Nile Agent Quarantine",
        "display": "Nile Agent Quarantine",
        "help": "Nile Agent Quarantine Policy",
        "description": "Quarantines a device on Nile Network by moving to Quarantine Segment",
        "file_name": "NileQuarantine.xml",
        "full_description": "<html>Use this policy template to quarantine a device that is non-compliant on Nile Network.</html>",
        "title_image": "connect_nile_quarantine.png"
      }
    ]
  }
}
