{
    "name": "clearpass",
    "groups": [{
        "name": "connect_clearpass_clearpass",
        "label": "ClearPass"
    }],
    "properties": [{
            "tag": "connect_clearpass_id",
            "label": "ClearPass Session ID",
            "description": "ClearPass Session ID",
            "type": "string",
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_username",
            "label": "ClearPass Username",
            "description": "ClearPass Username",
            "type": "string",
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_nasipaddress",
            "label": "ClearPass NAS IP Address",
            "description": "ClearPass NAS IP Address",
            "type": "string",
            "asset_portal": true,
            "inventory": {
                "enable": true,
                "description": "Inventory of clearpass NAS IP Address"
            },
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_acctstarttime",
            "label": "ClearPass ACCT Start Time",
            "description": "ClearPass ACCT Start Time",
            "type": "date",
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_callingstationid",
            "label": "ClearPass Calling Station ID",
            "description": "ClearPass Calling Station ID",
            "type": "string",
            "asset_portal": true,
            "inventory": {
                "enable": true,
                "description": "Inventory of ClearPass Calling Station ID"
            },
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_calledstationid",
            "label": "ClearPass Called Station ID",
            "description": "ClearPass Called Station ID",
            "type": "string",
            "asset_portal": true,
            "inventory": {
                "enable": true,
                "description": "Inventory of ClearPass Called Station ID"
            },
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_cppm_uuid",
            "label": "ClearPass CPPM UUID",
            "description": "ClearPass CPPM UUID",
            "type": "string",
            "asset_portal": true,
            "inventory": {
                "enable": true,
                "description": "Inventory of ClearPass CPPM UUID"
            },
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_nasportid",
            "label": "ClearPass NAS Port ID",
            "description": "ClearPass NAS Port ID",
            "type": "string",
            "asset_portal": true,
            "inventory": {
                "enable": true,
                "description": "Inventory of ClearPass NAS Port ID"
            },
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_nasporttype",
            "label": "ClearPass NAS Port Type",
            "description": "ClearPass NAS Port Type",
            "type": "string",
            "asset_portal": true,
            "inventory": {
                "enable": true,
                "description": "Inventory of ClearPass NAS Port Type"
            },
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_nas_name",
            "label": "ClearPass NAS Name",
            "description": "ClearPass NAS Name",
            "type": "string",
            "asset_portal": true,
            "inventory": {
                "enable": true,
                "description": "Inventory of ClearPass NAS Name"
            },
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_acctterminatecause",
            "label": "ClearPass ACCT Terminate Cause",
            "description": "ClearPass ACCT Terminate Cause",
            "type": "string",
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_servicetype",
            "label": "ClearPass Service Type",
            "description": "ClearPass Service Type",
            "type": "string",
            "asset_portal": true,
            "inventory": {
                "enable": true,
                "description": "Inventory of ClearPass Service Type"
            },
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_ssid",
            "label": "ClearPass SSID",
            "description": "ClearPass SSID",
            "type": "string",
            "asset_portal": true,
            "inventory": {
                "enable": true,
                "description": "Inventory of clearpass SSID"
            },
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_ap_name",
            "label": "ClearPass AP Name",
            "description": "ClearPass AP Name",
            "type": "string",
            "asset_portal": true,
            "inventory": {
                "enable": true,
                "description": "Inventory of ClearPass AP Name"
            },
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_mac_address",
            "label": "ClearPass MAC Address",
            "description": "ClearPass MAC Address",
            "type": "string",
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_visitor_name",
            "label": "ClearPass Visitor Name",
            "description": "ClearPass Visitor Name",
            "type": "string",
            "asset_portal": true,
            "inventory": {
                "enable": true,
                "description": "Inventory of ClearPass Visitor Name"
            },
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_visitor_company",
            "label": "ClearPass Visitor Company",
            "description": "ClearPass Visitor Company",
            "type": "string",
            "asset_portal": true,
            "inventory": {
                "enable": true,
                "description": "Inventory of ClearPass Visitor Company"
            },
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_visitor_phone",
            "label": "ClearPass Visitor Phone Number",
            "description": "ClearPass Visitor Phone Number",
            "type": "string",
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_sponsor_name",
            "label": "ClearPass Sponsor Name",
            "description": "ClearPass Sponsor Name",
            "type": "string",
            "asset_portal": true,
            "inventory": {
                "enable": true,
                "description": "Inventory of clearpass Sponsor Name"
            },
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_sponsor_email",
            "label": "ClearPass Sponsor Email",
            "description": "ClearPass Sponsor Email",
            "type": "string",
            "asset_portal": true,
            "inventory": {
                "enable": true,
                "description": "Inventory of ClearPass Sponsor Email"
            },
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_sponsor_profile_name",
            "label": "ClearPass Sponsor Profile Name",
            "description": "ClearPass Sponsor Profile Name",
            "type": "string",
            "asset_portal": true,
            "inventory": {
                "enable": true,
                "description": "Inventory of ClearPass Sponsor Profile Name"
            },
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "tag": "connect_clearpass_role_name",
            "label": "ClearPass Role Name",
            "description": "ClearPass Role Name",
            "type": "string",
            "asset_portal": true,
            "inventory": {
                "enable": true,
                "description": "Inventory of clearpass role_name"
            },
            "group": "connect_clearpass_clearpass",
            "resolvable": true,
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        }
    ],
    "action_groups": [{
        "name": "connect_clearpass_clearpass",
        "label": "Aruba ClearPass"
    }],
    "actions": [{
            "name": "connect_clearpass_action_reauthorize",
            "label": "ClearPass Change Profile",
            "group": "connect_clearpass_clearpass",
            "description": "Change the profile for the device",
            "ip_required": false,
            "threshold_percentage": 1,
            "params": [{
                "name": "connect_clearpass_reauthorize_profile",
                "label": "Profile Name",
                "description": "Change the device profile",
                "type": "string",
                "multiline": false
            }],
            "dependencies": [{
                "name": "connect_clearpass_id",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "name": "connect_clearpass_fs_action_attribute",
            "label": "ClearPass Update Forescout-ACTION Attribute",
            "group": "connect_clearpass_clearpass",
            "description": "ClearPass Update Forescout-ACTION Attribute",
            "ip_required": false,
            "threshold_percentage": 1,
            "params": [{
                "name": "connect_clearpass_fs_action_attribute",
                "label": "Update Forescout-ACTION Endpoint Attribute",
                "description": "Update Forescout-ACTION Attribute",
                "type": "string",
                "multiline": false
            }],
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        },
        {
            "name": "connect_clearpass_custom_attributes",
            "label": "ClearPass Update Endpoint Custom Attributes",
            "group": "connect_clearpass_clearpass",
            "description": "ClearPass Update Endpoint Attributes. Allows for free form custom JSON body.",
            "ip_required": false,
            "threshold_percentage": 1,
            "params": [{
                "name": "connect_clearpass_custom_attributes",
                "label": "Update Endpoint Attribute(s)",
                "description": "Add a JSON Object.",
                "type": "string",
                "default": "{\n    \"attributes\": {\n        \"Forescout-Status\": \"Testing\",\n        \"Forescout-Environment\": \"Test\"\n    }\n}",
                "multiline": true
            }],
            "dependencies": [{
                "name": "mac",
                "redo_new": true,
                "redo_change": true
            }]
        }
    ],
    "scripts": [{
            "name": "clearpass_resolve.py",
            "properties": [
                "connect_clearpass_id",
                "connect_clearpass_username",
                "connect_clearpass_nasipaddress",
                "connect_clearpass_acctstarttime",
                "connect_clearpass_callingstationid",
                "connect_clearpass_calledstationid",
                "connect_clearpass_cppm_uuid",
                "connect_clearpass_nasportid",
                "connect_clearpass_nasporttype",
                "connect_clearpass_nas_name",
                "connect_clearpass_acctterminatecause",
                "connect_clearpass_servicetype",
                "connect_clearpass_ssid",
                "connect_clearpass_ap_name",
                "connect_clearpass_mac_address",
                "connect_clearpass_visitor_name",
                "connect_clearpass_visitor_company",
                "connect_clearpass_visitor_phone",
                "connect_clearpass_sponsor_name",
                "connect_clearpass_sponsor_email",
                "connect_clearpass_sponsor_profile_name",
                "connect_clearpass_role_name"
            ]
        },
        {
            "name": "clearpass_reauth_profile.py",
            "actions": [
                "connect_clearpass_action_reauthorize"
            ]
        },
        {
            "name": "clearpass_attribute_fs_action_attribute.py",
            "actions": [
                "connect_clearpass_fs_action_attribute"
            ]
        },
        {
            "name": "clearpass_attribute_custom_attributes.py",
            "actions": [
                "connect_clearpass_custom_attributes"
            ]
        },
        {
            "name": "clearpass_test.py",
            "test": true
        },
        {
            "name": "clearpass_authorization.py",
            "authorization": true
        }
    ],
    "policy_template": {
        "policy_template_group": {
            "name": "connect_clearpass",
            "label": "ClearPass",
            "display": "ClearPass",
            "description": "ClearPass Template(s)",
            "full_description": "<html>Use ClearPass policy templates to manage devices in a ClearPass environment</html>",
            "title_image": "connect_clearpass.png",
            "bg_image": "connect_clearpass.png"
        },
        "policies": [{
            "name": "connect_clearpass_discovery",
            "label": "ClearPass Query For Session ID",
            "display": "ClearPass Query Session ID",
            "help": "Queries ClearPass for Session ID. Query using MAC address.",
            "description": "Queries ClearPass for Session ID. Query using MAC address.",
            "file_name": "ClearPass-Session-ID.xml",
            "full_description": "<html>Queries ClearPass for Session ID. Query using MAC address.</html>",
            "title_image": "connect_clearpass.png"
        },
        {
            "name": "connect_clearpass_allow_deny",
            "label": "ClearPass Allow or Deny Endpoint Access",
            "display": "ClearPass Allow or Deny Endpoint Access",
            "help": "Endpoints in Group : AllowAccess or DenyAccess<br>Update endpoint attributes",
            "description": "Endpoints in Group : AllowAccess or DenyAccess<br>Update endpoint attributes",
            "file_name": "ClearPass-Allow-or-Deny-Endpoint-Access.xml",
            "full_description": "<html>ACTIONS DISABLED BY DEFAULT<br><br>Endpoints in Group : AllowAccess or DenyAccess<br><br>1. Tag the endpoint with DenyAccess or AllowAccess<br><br>NOTE<br>Change to your Corporate TAG string<br><br>2. Profile Change to Re-Authenticate the endpoint.<br><br>NOTE<br>Change to your Corporate Re-authenticate profile<br>Delay 5 seconds before sending action.</html>",
            "title_image": "connect_clearpass.png"
        }]
    }
}