{
  "name": "GoogleMDM",
  "groups": [
    {
      "name":"connect_googlemdm_googlemdm",
      "label":"Google MDM"
    }
  ],
  "properties": [
    {
      "tag": "connect_googlemdm_serial_number",
      "label": "Google MDM Serial Number",
      "description": "The serial number of the device retreived from Google MDM",
      "type": "string",
      "group": "connect_googlemdm_googlemdm",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "track_change": {
        "enable": true,
        "label": "Google MDM Serial Number Changed",
        "description": "Track Change property for Google MDM Serial Number"
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_googlemdm_device_id",
      "label": "Google MDM Device ID",
      "description": "The device id for the device retreived from Google MDM",
      "type": "string",
      "group": "connect_googlemdm_googlemdm",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "track_change": {
        "enable": true,
        "label": "Google MDM Device ID Changed",
        "description": "Track Change property for Google MDM Device ID"
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_googlemdm_mac_address",
      "label": "Google MDM MAC Address",
      "description": "The mac address of the device as represented in Google MDM",
      "type": "string",
      "group": "connect_googlemdm_googlemdm",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "track_change": {
        "enable": true,
        "label": "Google MDM MAC Address Changed",
        "description": "Track Change property for Google MDM MAC Address"
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_googlemdm_status",
      "label": "Google MDM Status",
      "description": "The status of the device as represented in Google MDM",
      "type": "string",
      "group": "connect_googlemdm_googlemdm",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Google MDM Status"
      },
      "track_change": {
        "enable": true,
        "label": "Google MDM Status Changed",
        "description": "Track Change property for Google MDM Status"
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_googlemdm_asset_id",
      "label": "Google MDM Asset ID",
      "description": "The asset ID of the device that is stored in Google MDM",
      "type": "string",
      "group": "connect_googlemdm_googlemdm",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "track_change": {
        "enable": true,
        "label": "Google MDM Asset ID Changed",
        "description": "Track Change property for Google MDM Asset ID"
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_googlemdm_org_unit",
      "label": "Google MDM Organizational Unit",
      "description": "The organizational unit of the device that is stored in Google MDM",
      "type": "string",
      "group": "connect_googlemdm_googlemdm",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Google MDM Organizational Unit"
      },
      "track_change": {
        "enable": true,
        "label": "Google MDM Organizational Unit Changed",
        "description": "Track Change property for Google MDM Organizational Unit"
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_googlemdm_model",
      "label": "Google MDM Model",
      "description": "The model of the unit labeled in Google MDM",
      "type": "string",
      "group": "connect_googlemdm_googlemdm",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Google MDM Model"
      },
      "track_change": {
        "enable": true,
        "label": "Google MDM Model Changed",
        "description": "Track Change property for Google MDM Model"
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_googlemdm_platform_version",
      "label": "Google MDM Platform Version",
      "description": "The platform version from Google MDM",
      "type": "string",
      "group": "connect_googlemdm_googlemdm",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Google MDM Platform Version"
      },
      "track_change": {
        "enable": true,
        "label": "GoogleMDM Platform Version Changed",
        "description": "Track Change property for Google MDM Platform Version"
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_googlemdm_firmware_version",
      "label": "Google MDM Firmware Version",
      "description": "The firmware version from Google MDM",
      "type": "string",
      "group": "connect_googlemdm_googlemdm",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Google MDM Firmware Version"
      },
      "track_change": {
        "enable": true,
        "label": "Google MDM Firmware Version Changed",
        "description": "Track Change property for Google MDM Firmware Version"
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_googlemdm_os_version",
      "label": "Google MDM OS Version",
      "description": "The os version from Google MDM",
      "type": "string",
      "group": "connect_googlemdm_googlemdm",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Google MDM OS Version"
      },
      "track_change": {
        "enable": true,
        "label": "Google MDM OS Version Changed",
        "description": "Track Change property for Google MDM OS Version"
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_googlemdm_boot_mode",
      "label": "Google MDM Boot Mode",
      "description": "The boot mode of the device from Google MDM",
      "type": "string",
      "group": "connect_googlemdm_googlemdm",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "inventory": {
        "enable": true,
        "description": "Inventory of Google MDM Boot Mode"
      },
      "track_change": {
        "enable": true,
        "label": "Google MDM Boot Mode Changed",
        "description": "Track Change property for Google MDM Boot Mode"
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_googlemdm_user",
      "label": "Google MDM User",
      "description": "The user of the device as stated in Google MDM",
      "type": "string",
      "group": "connect_googlemdm_googlemdm",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "track_change": {
        "enable": true,
        "label": "Google MDM User Changed",
        "description": "Track Change property for Google MDM User"
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_googlemdm_location",
      "label": "Google MDM Location",
      "description": "The location of the device as stated in Google MDM",
      "type": "string",
      "group": "connect_googlemdm_googlemdm",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "track_change": {
        "enable": true,
        "label": "Google MDM Location Changed",
        "description": "Track Change property for Google MDM Location"
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_googlemdm_notes",
      "label": "Google MDM Notes",
      "description": "The notes for the device as stated in Google MDM",
      "type": "string",
      "group": "connect_googlemdm_googlemdm",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "track_change": {
        "enable": true,
        "label": "Google MDM Notes Changed",
        "description": "Track Change property for Google MDM Notes"
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "tag": "connect_googlemdm_last_sync",
      "label": "Google MDM Last Sync",
      "description": "The last time the device was synchronized with Google MDM",
      "type": "string",
      "group": "connect_googlemdm_googlemdm",
      "resolvable": true,
      "require_host_access": false,
      "asset_portal": true,
      "track_change": {
        "enable": true,
        "label": "Google MDM Last Sync Changed",
        "description": "Track Change property for Google MDM Last Sync"
      },
      "dependencies": [
        {
          "name": "mac",
          "redo_new": true,
          "redo_change": true
        }
      ]
    }
  ],
  "action_groups": [
    {
      "name":"connect_googlemdm_googlemdm",
      "label":"GoogleMDM"
    }
  ],
  "actions": [
    {
      "name": "connect_googlemdm_enable_chrome_device",
      "label": "Chrome Device - Enable",
      "group": "connect_googlemdm_googlemdm",
      "description": "Enable a chrome device",
      "ip_required": false,
      "threshold_percentage": 1,
      "dependencies": [
        {
          "name": "connect_googlemdm_device_id",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "name": "connect_googlemdm_deprovision_chrome_device",
      "label": "Chrome Device - Deprovision",
      "group": "connect_googlemdm_googlemdm",
      "description": "Deprovision a chrome device",
      "ip_required": false,
      "threshold_percentage": 1,
      "params": [
        {
          "name": "googlemdm_reason",
          "label": "Deprovisioning Reason",
          "description": "Reason for the device to be deprovisioned",
          "type": "string"
        }
      ],
      "dependencies": [
        {
          "name": "connect_googlemdm_device_id",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "name": "connect_googlemdm_disable_chrome_device",
      "label": "Chrome Device - Disable",
      "group": "connect_googlemdm_googlemdm",
      "description": "Disable a chrome device",
      "ip_required": false,
      "threshold_percentage": 1,
      "dependencies": [
        {
          "name": "connect_googlemdm_device_id",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "name": "connect_googlemdm_change_org",
      "label": "Chrome Device - Change Org Unit",
      "group": "connect_googlemdm_googlemdm",
      "description": "Change the organizational unit of the device",
      "ip_required": false,
      "threshold_percentage": 1,
      "params": [
        {
          "name": "googlemdm_org_unit",
          "label": "Organizational Unit",
          "description": "The Google MDM Organizational Unit",
          "type": "string"
        }
      ],
      "dependencies": [
        {
          "name": "connect_googlemdm_device_id",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "name": "connect_googlemdm_update_asset_id",
      "label": "Chrome Device - Update Asset ID",
      "group": "connect_googlemdm_googlemdm",
      "description": "Update the Asset ID",
      "ip_required": false,
      "threshold_percentage": 1,
      "params": [
        {
          "name": "googlemdm_asset_id",
          "label": "Asset ID",
          "description": "The Google MDM Asset ID",
          "type": "string"
        }
      ],
      "dependencies": [
        {
          "name": "connect_googlemdm_device_id",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "name": "connect_googlemdm_update_notes",
      "label": "Chrome Device - Update Notes",
      "group": "connect_googlemdm_googlemdm",
      "description": "Update the Notes",
      "ip_required": false,
      "threshold_percentage": 1,
      "params": [
        {
          "name": "googlemdm_notes",
          "label": "Notes",
          "description": "The Google MDM Notes",
          "type": "string"
        }
      ],
      "dependencies": [
        {
          "name": "connect_googlemdm_device_id",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "name": "connect_googlemdm_update_location",
      "label": "Chrome Device - Update Location",
      "group": "connect_googlemdm_googlemdm",
      "description": "Update the location",
      "ip_required": false,
      "threshold_percentage": 1,
      "params": [
        {
          "name": "googlemdm_location",
          "label": "Location",
          "description": "The Google MDM Asset Location",
          "type": "string"
        }
      ],
      "dependencies": [
        {
          "name": "connect_googlemdm_device_id",
          "redo_new": true,
          "redo_change": true
        }
      ]
    },
    {
      "name": "connect_googlemdm_update_user",
      "label": "Chrome Device - Update User",
      "group": "connect_googlemdm_googlemdm",
      "description": "Update the user",
      "ip_required": false,
      "threshold_percentage": 1,
      "params": [
        {
          "name": "googlemdm_user",
          "label": "User",
          "description": "The Google MDM Asset User",
          "type": "string"
        }
      ],
      "dependencies": [
        {
          "name": "connect_googlemdm_device_id",
          "redo_new": true,
          "redo_change": true
        }
      ]
    }
  ],
  "scripts": [
    {
	    "name":"googlemdm_authorization.py",
	    "authorization":true
    },
    {
      "name": "googlemdm_resolve.py",
      "properties": [
        "connect_googlemdm_serial_number",
        "connect_googlemdm_mac_address",
        "connect_googlemdm_status",
        "connect_googlemdm_asset_id",
        "connect_googlemdm_platform_version",
        "connect_googlemdm_firmware_version",
        "connect_googlemdm_user",
        "connect_googlemdm_last_sync",
        "connect_googlemdm_device_id",
        "connect_googlemdm_model",
        "connect_googlemdm_os_version",
        "connect_googlemdm_boot_mode",
        "connect_googlemdm_org_unit",
        "connect_googlemdm_location",
        "connect_googlemdm_notes"
      ]

    },
    {
      "name": "googlemdm_enable_chrome_device.py",
      "actions": [
        "connect_googlemdm_enable_chrome_device"
      ]
    },
    {
      "name": "connect_googlemdm_deprovision_chrome_device.py",
      "actions": [
        "connect_googlemdm_deprovision_chrome_device"
      ]
    },
    {
      "name": "googlemdm_disable_chrome_device.py",
      "actions": [
        "connect_googlemdm_disable_chrome_device"
      ]
    },
    {
      "name": "googlemdm_update_asset_id.py",
      "actions": [
        "connect_googlemdm_update_asset_id"
      ]
    },
    {
      "name": "googlemdm_update_location.py",
      "actions": [
        "connect_googlemdm_update_location"
      ]
    },
    {
      "name": "googlemdm_update_user.py",
      "actions": [
        "connect_googlemdm_update_user"
      ]
    },
    {
      "name": "googlemdm_change_org.py",
      "actions": [
        "connect_googlemdm_change_org"
      ]
    },
    {
      "name": "googlemdm_update_notes.py",
      "actions": [
        "connect_googlemdm_update_notes"
      ]
    },
    {
      "name": "googlemdm_test.py",
      "test": true
    },
    {
      "name": "googlemdm_poll.py",
      "discovery": true
    }
  ],
  "policy_template": {
    "policy_template_group": {
       "name": "connect_googlemdm",
       "label": "Google MDM",
       "display": "Google MDM",
       "description": "Google MDM templates",
       "full_description": "<html>Use Google MDM policy templates to manage devices in a Google MDM environment:<ul><li>Detect devices that are compliant.</li></ul></html>",
       "title_image": "connect_googlemdm.png"
    },
    "policies": [
      {
        "name": "connect_googlemdm_chromebook_boot",
        "label": "Chromebook Boot Verification",
        "display": "Chromebook Boot Verification",
        "help": "Chromebook Boot Policy",
        "description": "Creates Google MDM policy to check for Chromebook boot status",
        "file_name": "ChromebookBootVerification.xml",
        "full_description": "<html>Use this policy template to identify the boot status of a Chromebook.</html>",
        "title_image": "connect_googlemdm.png"
      },
      {
        "name": "connect_googlemdm_chromebook_classification",
        "label": "Chromebook Classification",
        "display": "Chromebook Classification",
        "help": "Chromebook Classification Policy",
        "description": "Creates Google MDM policy to further classify a Chromebook",
        "file_name": "ChromebookClassification.xml",
        "full_description": "<html>Use this policy template to identify and classify a chromebook.</html>",
        "title_image": "connect_googlemdm.png"
      },
      {
        "name": "connect_googlemdm_chromebook_manage",
        "label": "Chromebook Device Manageability",
        "display": "Chromebook Device Manageability",
        "help": "Chromebook manageability policy",
        "description": "Creates Google MDM policy to determine whether a Chromebook is manageable.",
        "file_name": "ChromebookDeviceManageability.xml",
        "full_description": "<html>Use this policy template to identify the manageability of a chromebook.</html>",
        "title_image": "connect_googlemdm.png"
      },
      {
        "name": "connect_googlemdm_chromebook_networkcontrol",
        "label": "Chromebook Network Control",
        "display": "Chromebook Network Control",
        "help": "Chromebook network control policy",
        "description": "Creates Google MDM policy to control whether a Chromebook is able to access the network or not.",
        "file_name": "ChromebookNetworkControl.xml",
        "full_description": "<html>Use this policy template to control the access of a chromebook to the network.</html>",
        "title_image": "connect_googlemdm.png"
      },
      {
        "name": "connect_googlemdm_chromebook_officialplatform",
        "label": "Chromebook Official Platform",
        "display": "Chromebook Official Platform",
        "help": "Chromebook official platform confirmation policy",
        "description": "Creates Google MDM policy to determine whether a Chromebook is running an official platform.",
        "file_name": "ChromebookOfficialPlatform.xml",
        "full_description": "<html>Use this policy template to determine whether a Chromebook has an offical platform installed according to the validation within Google MDM cloud.</html>",
        "title_image": "connect_googlemdm.png"
      },
      {
        "name": "connect_googlemdm_chromebook_quarantine",
        "label": "Chromebook Quarantine",
        "display": "Chromebook Quarantine",
        "help": "Chromebook quarantine policy",
        "description": "Creates Google MDM policy to determine whether a Chromebook should be quarantined or not.",
        "file_name": "ChromebookNetworkControl.xml",
        "full_description": "<html>Use this policy template to determine the eligibility of a chromebook for quarantine.</html>",
        "title_image": "connect_googlemdm.png"
      }
    ]
  }
}
