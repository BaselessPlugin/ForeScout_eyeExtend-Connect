{
    "name": "appgatesdp",
    "groups": [
        {
            "name": "connect_appgatesdp_appgatesdp",
            "label": "Appgate SDP"
        }
    ],
    "properties": [
        {
            "tag": "connect_appgatesdp_extip",
            "label": "Appgate Client External IP",
            "description": "Client External IP",
            "type": "string",
            "group": "connect_appgatesdp_appgatesdp",
            "resolvable": true,
            "dependencies": [
                {
                    "name": "connect_appgatesdp_id",
                    "redo_new": true,
                    "redo_change": true
                },
                {
                    "name": "connect_appgatesdp_user",
                    "redo_new": true,
                    "redo_change": true
                },
                {
                    "name": "connect_appgatesdp_idp",
                    "redo_new": true,
                    "redo_change": true
                }
            ]
        },
        {
            "tag": "connect_appgatesdp_id",
            "label": "Appgate Client Device ID",
            "description": "Client Device ID",
            "type": "string",
            "group": "connect_appgatesdp_appgatesdp",
            "resolvable": false,
            "dependencies": [
                {
                    "name": "ip",
                    "redo_new": true,
                    "redo_change": true
                }
            ]
        },
        {
            "tag": "connect_appgatesdp_user",
            "label": "Appgate SDP User",
            "description": "Appgate SDP User",
            "type": "string",
            "group": "connect_appgatesdp_appgatesdp",
            "resolvable": false,
            "dependencies": [
                {
                    "name": "ip",
                    "redo_new": true,
                    "redo_change": true
                }
            ]
        },
        {
            "tag": "connect_appgatesdp_idp",
            "label": "Appgate Client Identity Provider",
            "description": "Identity Provider",
            "type": "string",
            "group": "connect_appgatesdp_appgatesdp",
            "resolvable": false,
            "dependencies": [
                {
                    "name": "ip",
                    "redo_new": true,
                    "redo_change": true
                }
            ]
        },
        {
            "tag": "connect_appgatesdp_sites",
            "label": "Appgate Client Connected Sites",
            "description": "Sites the Client is connected to",
            "type": "string",
            "group": "connect_appgatesdp_appgatesdp",
            "resolvable": true,
            "dependencies": [
                {
                    "name": "connect_appgatesdp_id",
                    "redo_new": true,
                    "redo_change": true
                },
                {
                    "name": "connect_appgatesdp_user",
                    "redo_new": true,
                    "redo_change": true
                },
                {
                    "name": "connect_appgatesdp_idp",
                    "redo_new": true,
                    "redo_change": true
                }
            ]
        },
        {
            "tag": "connect_appgatesdp_hostname",
            "label": "Appgate Client hostname",
            "description": "Client hostname",
            "type": "string",
            "group": "connect_appgatesdp_appgatesdp",
            "resolvable": true,
            "dependencies": [
                {
                    "name": "connect_appgatesdp_id",
                    "redo_new": true,
                    "redo_change": true
                },
                {
                    "name": "connect_appgatesdp_user",
                    "redo_new": true,
                    "redo_change": true
                },
                {
                    "name": "connect_appgatesdp_idp",
                    "redo_new": true,
                    "redo_change": true
                }
            ]
        },
        {
            "tag": "connect_appgatesdp_os",
            "label": "Appgate Client OS",
            "description": "Client OS",
            "type": "string",
            "group": "connect_appgatesdp_appgatesdp",
            "resolvable": true,
            "dependencies": [
                {
                    "name": "connect_appgatesdp_id",
                    "redo_new": true,
                    "redo_change": true
                },
                {
                    "name": "connect_appgatesdp_user",
                    "redo_new": true,
                    "redo_change": true
                },
                {
                    "name": "connect_appgatesdp_idp",
                    "redo_new": true,
                    "redo_change": true
                }
            ]
        },
        {
            "tag": "connect_appgatesdp_country",
            "label": "Appgate Client Country Code",
            "description": "Client Country Code",
            "type": "string",
            "group": "connect_appgatesdp_appgatesdp",
            "resolvable": true,
            "dependencies": [
                {
                    "name": "connect_appgatesdp_id",
                    "redo_new": true,
                    "redo_change": true
                },
                {
                    "name": "connect_appgatesdp_user",
                    "redo_new": true,
                    "redo_change": true
                },
                {
                    "name": "connect_appgatesdp_idp",
                    "redo_new": true,
                    "redo_change": true
                }
            ]
        },
        {
            "tag": "connect_appgatesdp_isdomain",
            "label": "Appgate Client is Domain",
            "description": "Client is Domain",
            "type": "boolean",
            "group": "connect_appgatesdp_appgatesdp",
            "resolvable": true,
            "dependencies": [
                {
                    "name": "connect_appgatesdp_id",
                    "redo_new": true,
                    "redo_change": true
                },
                {
                    "name": "connect_appgatesdp_user",
                    "redo_new": true,
                    "redo_change": true
                },
                {
                    "name": "connect_appgatesdp_idp",
                    "redo_new": true,
                    "redo_change": true
                }
            ]
        },
        {
            "tag": "connect_appgatesdp_isuseradmin",
            "label": "Appgate Client is user admin",
            "description": "Does logged in user have admin rights in the system",
            "type": "boolean",
            "group": "connect_appgatesdp_appgatesdp",
            "resolvable": true,
            "dependencies": [
                {
                    "name": "connect_appgatesdp_id",
                    "redo_new": true,
                    "redo_change": true
                },
                {
                    "name": "connect_appgatesdp_user",
                    "redo_new": true,
                    "redo_change": true
                },
                {
                    "name": "connect_appgatesdp_idp",
                    "redo_new": true,
                    "redo_change": true
                }
            ]
        },
        {
            "tag": "connect_appgatesdp_isfwenabled",
            "label": "Appgate Client is Firewann enabled",
            "description": "Is local firewall enbled in the system",
            "type": "boolean",
            "group": "connect_appgatesdp_appgatesdp",
            "resolvable": true,
            "dependencies": [
                {
                    "name": "connect_appgatesdp_id",
                    "redo_new": true,
                    "redo_change": true
                },
                {
                    "name": "connect_appgatesdp_user",
                    "redo_new": true,
                    "redo_change": true
                },
                {
                    "name": "connect_appgatesdp_idp",
                    "redo_new": true,
                    "redo_change": true
                }
            ]
        }
    ],
    "action_groups": [
        {
            "name": "connect_appgatesdp_actions",
            "label": "Appgate SDP"
        }
    ],    
    "actions": [
        {
            "name": "connect_appgatesdp_blacklist_user",
            "label": "Blacklist User",
            "group": "connect_appgatesdp_actions",
            "description": "Blacklist Appgate SDP User",
            "ip_required": true,
            "dependencies": [
                {
                    "name": "connect_appgatesdp_user",
                    "redo_new": true,
                    "redo_change": true
                },
                {
                    "name": "connect_appgatesdp_idp"
                }
            ],
            "undo": {
                "label": "Cancel Blacklist User",
                "description": "Cancel Blacklist Appgate SDP User"
            }
        }
	],
    "scripts": [
        {
            "name": "appgate_poll.py",
            "discovery": true,
			"properties": [
				"connect_appgatesdp_id",
				"connect_appgatesdp_user",
				"connect_appgatesdp_idp"
			]
        },
        {
            "name": "appgate_getprops.py",
			"properties": [
				"connect_appgatesdp_extip",
                "connect_appgatesdp_sites",
				"connect_appgatesdp_hostname",
				"connect_appgatesdp_os",
				"connect_appgatesdp_country",
				"connect_appgatesdp_isdomain",
				"connect_appgatesdp_isuseradmin",
				"connect_appgatesdp_isfwenabled"
			]
        },
        {
            "name": "appgate_authorize.py",
            "authorization": true
        },
        {
            "name": "appgate_test.py",
            "test": true
        },
        {
            "name": "appgate_blacklist.py",
            "actions": [
                "connect_appgatesdp_blacklist_user"
            ]
        },
        {
            "name": "appgate_unblacklist.py",
            "is_cancel": true,
            "actions": [
                "connect_appgatesdp_blacklist_user"  
            ]
        },
        {
            "name": "appgate_api.py",
            "library_file": true
        },
        {
            "name": "appgate_syslog.py",
            "syslog_message": true
        }
    ],
	"policy_template": {
		"policy_template_group": {
			"name": "connect_appgatesdp",
			"label": "Appgate SDP",
			"display": "Appgate SDP",
			"description": "Appgate SDP policy templates",
			"full_description": "<html>Appgate SDP policy templates</html>",
			"title_image": "connect_appgatesdp.png"
		},
		"policies": [
			{
				"name": "connect_appgatesdp_discovery",
				"label": "Appgate SDP Discovery",
				"display": "Appgate SDP Properties Discovery",
				"help": "Appgate SDP Client Device Properties Discovery",
				"description": "Discover additional client device properties from Appgate Controller",
				"file_name": "Appgate Client Properties Discovery.xml",
				"full_description": "<html>Learn additional properties of devices connected to Appgate SDP.<br>For this policy to succeed, Forescout must already know Device ID, User and its IdP from Syslog. <br>The flow is the following:<br><ul><li>Once an endpoint is connected to Appgate, the Controller then sends a syslog message containing Device Tunnel IP, Device ID, Username and IdP to Forescout</li><li>Connect App parses the message and learns those properties immeditely upon connection.</li><li>This policy then uses these properties to trigger Connect App to query Controller for additionat device properties.</ul>These properties can be also learned during Appgate Controller polling, but this policy expedites this process and gives a possibility to reduce network and API load.</html>",
				"title_image": "connect_appgatesdp.png"
			}
		]
	}
}